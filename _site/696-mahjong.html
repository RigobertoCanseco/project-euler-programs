<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>696 Mahjong</title>

  <!-- Begin Jekyll SEO tag v2.6.1 -->
<meta name="generator" content="Jekyll v3.8.7" />
<meta property="og:title" content="696 Mahjong" />
<meta name="author" content="Rigoberto Canseco" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Problem 696 https://projecteuler.net/problem=696" />
<meta property="og:description" content="Problem 696 https://projecteuler.net/problem=696" />
<link rel="canonical" href="http://localhost:4000/project-euler-problems/696-mahjong.html" />
<meta property="og:url" content="http://localhost:4000/project-euler-problems/696-mahjong.html" />
<meta property="og:site_name" content="Project Euler" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-11T00:00:00-06:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"696 Mahjong","dateModified":"2021-02-11T00:00:00-06:00","datePublished":"2021-02-11T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/project-euler-problems/696-mahjong.html"},"author":{"@type":"Person","name":"Rigoberto Canseco"},"description":"Problem 696 https://projecteuler.net/problem=696","url":"http://localhost:4000/project-euler-problems/696-mahjong.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/project-euler-problems/feed.xml" title="Project Euler" />

  <link rel="shortcut icon" type="image/x-icon" href="/project-euler-problems/logo.png" />
  <link rel="stylesheet" href="/project-euler-problems/assets/css/main.css" />
  <link rel="stylesheet" href="/project-euler-problems/assets/css/syntax.css" type="text/css" /><script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
    },
    CommonHTML: {
      scale: 70,
    }
  });
</script>
<script type="text/javascript" async
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script></head><body a="auto">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <a href="/project-euler-problems/"><=</a>

<article>
  <h1>696 Mahjong</h1>

  <p><strong>Problem 696</strong><br />
<a href="https://projecteuler.net/problem=696">https://projecteuler.net/problem=696</a></p>

<p>The game of Mahjong is played with tiles belonging to $s$ <i>suits</i>. Each tile also has a <i>number</i> in the range $1\ldots n$, and for each suit/number combination there are exactly four indistinguishable tiles with that suit and number. (The real Mahjong game also contains other bonus tiles, but those will not feature in this problem.)</p>

<p>A <i>winning hand</i> is a collection of $3t+2$ Tiles (where $t$ is a fixed integer) that can be arranged as $t$ <i>Triples</i> and one <i>Pair</i>, where:</p>
<ul>
<li>A <i>Triple</i> is either a <i>Chow</i> or a <i>Pung</i></li>
<li>A <i>Chow</i> is three tiles of the same suit and consecutive numbers</li>
<li>A <i>Pung</i> is three identical tiles (same suit and same number)</li>
<li>A <i>Pair</i> is two identical tiles (same suit and same number)</li>
</ul>

<p>For example, here is a winning hand with $n=9$, $s=3$, $t=4$, consisting in this case of two Chows, two Pungs, and one Pair:</p>
<div class="center">
<img src="https://projecteuler.net/project/images/p696_mahjong_1.png" alt="A winning Mahjong hand" />
</div>

<p>Note that sometimes the same collection of tiles can be represented as $t$ Triples and one Pair in more than one way. This only counts as one winning hand. For example, this is considered to be the same winning hand as above, because it consists of the same tiles:</p>
<div class="center">
<img src="https://projecteuler.net/project/images/p696_mahjong_2.png" alt="Alternative arrangement of the same hand" />
</div>

<p>Let $w(n, s, t)$ be the number of distinct winning hands formed of $t$ Triples and one Pair, where there are $s$ suits available and tiles are numbered up to $n$.</p>

<p>For example, with a single suit and tiles numbered up to 4, we have $w(4, 1, 1) = 20$: there are 12 winning hands consisting of a Pung and a Pair, and another 8 containing a Chow and a Pair. You are also given that $w(9, 1, 4) = 13259$, $w(9, 3, 4) = 5237550$, and $w(1000, 1000, 5) \equiv 107662178 \pmod{1\,000\,000\,007}$.</p>

<p>Find $w(10^8, 10^8, 30)$. Give your answer modulo $1\,000\,000\,007$.</p>

<hr />

</article>
      </div>
    </main>
    
  </body>
</html>